<header>
  <nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800">
    <div
      class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"
    >
      <a href="/" class="flex items-center">
        <span
          class="self-center text-xl font-semibold whitespace-nowrap dark:text-white"
          ><%= config.NAME %></span
        >
      </a>

      <div class="flex items-center lg:order-2">
        <!-- Panier visible pour tout le monde -->
        <a href="#" class="text-white mr-4">
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M3 3h18l-1.5 9h-15L3 3zM5 13h14a2 2 0 0 1 1.9 1.4l1.5 6a2 2 0 0 1-1.9 2.6H6a2 2 0 0 1-1.9-2.6l1.5-6A2 2 0 0 1 5 13z"
              fill="none"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            ></path>
          </svg>
        </a>

        <!-- Si non connecté : bouton Login -->
        <% if (!user) { %>
        <a
          href="/login"
          class="bg-blue-500 dark:bg-blue-700 text-white dark:text-white hover:bg-blue-400 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-4 lg:px-5 py-2 lg:py-2.5 mr-2 dark:hover:bg-blue-600 focus:outline-none dark:focus:ring-blue-800"
        >
          Login
        </a>
        <% } %>

        <!-- Si connecté : afficher l'avatar utilisateur et le menu déroulant -->
        <% if (user) { %>
        <div class="relative">
          <button id="user-avatar-btn" class="flex items-center">
            <svg
              class="w-8 h-8 text-white"
              fill="currentColor"
              viewBox="0 0 20 20"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M10 2a3 3 0 11-3 3 3 3 0 013-3zM2 18a8 8 0 1116 0H2z"
              ></path>
            </svg>
          </button>
          <!-- Dropdown menu -->
          <div
            id="user-dropdown"
            class="absolute hidden right-0 mt-2 bg-white rounded-lg shadow-lg w-48 dark:bg-gray-700"
          >
            <ul class="text-sm text-gray-700 dark:text-gray-200">
              <li>
                <a href="/profile" class="block px-4 py-2 text-sm">Profile</a>
              </li>
              <li>
                <a href="/logout" class="block px-4 py-2 text-sm">Logout</a>
              </li>
            </ul>
          </div>
        </div>
        <% } %>

        <button
          data-collapse-toggle="mobile-menu-2"
          type="button"
          class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
          aria-controls="mobile-menu-2"
          aria-expanded="false"
        >
          <span class="sr-only">Open main menu</span>
          <svg
            class="w-6 h-6"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
              clip-rule="evenodd"
            ></path>
          </svg>
        </button>
      </div>

      <!-- Menu mobile -->
      <div
        class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1"
        id="mobile-menu-2"
      >
        <ul
          class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"
        >
          <% if (!user) { %>
          <!-- Pour non connecté : liens généraux -->
          <li>
            <a
              href="/home"
              class="block py-2 pr-4 pl-3 text-white rounded bg-primary-700 lg:bg-transparent lg:text-primary-700 lg:p-0 dark:text-white"
              >Home</a
            >
          </li>
          <li>
            <a
              href="/about"
              class="block py-2 pr-4 pl-3 text-white rounded bg-primary-700 lg:bg-transparent lg:text-primary-700 lg:p-0 dark:text-white"
              >About</a
            >
          </li>
          <% } else { %>
          <!-- Liens visibles seulement quand connecté -->
          <li>
            <a
              href="/dashboard"
              class="block py-2 pr-4 pl-3 text-white rounded bg-primary-700 lg:bg-transparent lg:text-primary-700 lg:p-0 dark:text-white"
              >Dashboard</a
            >
          </li>
          <% } %>
        </ul>
      </div>
    </div>
  </nav>
</header>

<!-- Scripts pour gérer le dropdown -->
<script>
  document
    .getElementById("user-avatar-btn")
    .addEventListener("click", function () {
      const dropdown = document.getElementById("user-dropdown");
      dropdown.classList.toggle("hidden"); // Toggle the visibility of the dropdown
    });
</script>
